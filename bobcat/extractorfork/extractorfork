#ifndef INCLUDED_BOBCAT_EXTRACTORFORK_
#define INCLUDED_BOBCAT_EXTRACTORFORK_

#include <istream>

#include <bobcat/pipe>
#include <bobcat/ifdstreambuf>
#include <bobcat/execfork>

namespace FBB
{

class ExtractorFork: private ExecFork, 
                     private FBB::IFdStreambuf, public std::istream
                     
{                    // the child process inserts into the pipe,
    size_t d_bufSize;
    Pipe d_iChildOutPipe;           // cout written by the CHILD

    public:
        ExtractorFork(size_t d_bufSize = 100);
        ~ExtractorFork() override;
        bool execute(std::string const &cmd);
        using ExecFork::ret;

    private:
        void childRedirections() override;
        void parentRedirections() override;
};

} // namespace FBB
        
#endif
